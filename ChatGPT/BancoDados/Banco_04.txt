Crie uma funÃ§Ã£o que copie os dados de uma planilha Excel chamada "Propostas.xlsx" na aba "Propostas" 
para um banco de dados no supabase para uma tabela chamada "propostas" jÃ¡ existente e com a estrutura similar as colunas da planilha. 
Similar a funÃ§Ã£o "importar_itens_excel_para_supabase criada anteriormente".
ApÃ³s leitura da planilha e antes de enviar os dados para a tabela "propostas", elimine a coluna "Codigo"
=============================================================================================================
Aqui estÃ¡ a funÃ§Ã£o pronta, seguindo exatamente o mesmo padrÃ£o da funÃ§Ã£o importar_itens_excel_para_supabase, mas agora para:

ğŸ“„ Planilha: Propostas.xlsx
ğŸ“‘ Aba: Propostas
ğŸ—„ Tabela no Supabase: propostas
âŒ Remover coluna antes de enviar: Codigo

âœ… FunÃ§Ã£o: importar_propostas_excel_para_supabase
import pandas as pd
from supabase import create_client, Client

def importar_propostas_excel_para_supabase(caminho_excel: str, supabase_url: str, supabase_key: str):
    """
    LÃª a aba 'Propostas' da planilha Propostas.xlsx, remove a coluna 'Codigo',
    e insere os dados na tabela 'propostas' no Supabase.
    """

    # ----------------------------
    # 1. ConexÃ£o com o Supabase
    # ----------------------------
    supabase: Client = create_client(supabase_url, supabase_key)

    # ----------------------------
    # 2. Leitura da aba Propostas
    # ----------------------------
    try:
        df = pd.read_excel(caminho_excel, sheet_name="Propostas")
    except Exception as e:
        print("Erro ao ler a planilha:", e)
        return

    # ----------------------------
    # 3. Remover coluna indesejada
    # ----------------------------
    if "Codigo" in df.columns:
        df = df.drop(columns=["Codigo"])

    # ----------------------------
    # 4. Converter NaN â†’ None
    # ----------------------------
    df = df.where(pd.notnull(df), None)

    # ----------------------------
    # 5. Inserir no Supabase
    # ----------------------------
    registros = df.to_dict(orient="records")

    try:
        for chunk_start in range(0, len(registros), 1000):
            chunk = registros[chunk_start:chunk_start+1000]
            supabase.table("propostas").insert(chunk).execute()

        print("ImportaÃ§Ã£o realizada com sucesso!")
    except Exception as e:
        print("Erro ao inserir dados no Supabase:", e)

ğŸ“Œ Como usar
importar_propostas_excel_para_supabase(
    caminho_excel="Propostas.xlsx",
    supabase_url=SUPABASE_URL,
    supabase_key=SUPABASE_KEY
)

